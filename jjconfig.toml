#:schema https://docs.jj-vcs.dev/latest/config-schema.json

[user]
name = "David Nguyen"
email = "david.nguyen@datadoghq.com"

[[--scope]]
--when.repositories = ["/Users/david.nguyen"]

[--scope.signing]
behavior = "own"
backend = "ssh"
key = "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIC+MNGBrTEwWXjCWynzMdFGu4tt1dI1ZE5ghj6RORt75"

[revset-aliases]
'wip' = 'trunk()..'
'wip_heads' = 'heads(wip)'
'branch(b)' = 'trunk()..bookmarks(b)'
# Get the merge commit that introduced a specific commit x into trunk
'merge(x)' = 'roots(merges() & trunk() & x::)'
# Find two specific commits and their merge commits to see which one was included first
'cmp(x, y)' = 'merge(x)|merge(y)|x|y'
'me' = 'mine()'

[aliases]
'mm' = ['new', 'wip_heads', '-m', 'megamerge']
'rba' = ['rebase', '-r', 'wip', '-d', 'trunk()']
'a' = ['log', '-r', 'all()']

[git]
# Prevent pushing work in progress or anything explicitly labeled "private"
private-commits = "description(glob:'wip:*') | description(glob:'private:*')"

[templates]
git_push_bookmark = """
  truncate_end(
    244,
    separate(
      "/",
      "dang",
      jira_issue_prefix(description),
      first_line_suffix(description),
    ),
  )
"""

[template-aliases]
"jira_issue_prefix(description)" = """
  description
    .match(regex:"^[[:upper:]]+-[[:digit:]]+[[:blank:]]+")
    .replace(regex:"[[:blank:]]+", "")
"""
"first_line_suffix(description)" = """
  description
    .first_line()
    .remove_prefix(jira_issue_prefix(description))
    .lower()
    .replace(regex:"[[:^word:]]", "-")
    .replace(regex:"-+", "-")
    .replace(regex:"^-|-$", "")
"""

[fsmonitor]
backend = "watchman"
[fsmonitor.watchman]
register-snapshot-trigger = true

[colors]
"diff removed token" = { underline = false }
"diff added token" = { underline = false }
"diff token" = { underline = false }

[ui]
default-command = "log"
diff-formatter = ":git"
revsets-use-glob-by-default = true
